---
import { AstroSeo } from '@astrolib/seo';
import { GoogleAnalytics } from '@astrolib/analytics';
import type { MetaSEO } from '~/types';
// Import the global.css file here so that it is included on
// all pages through the use of the <BaseHead /> component.
import { SITE } from '~/config.mjs';
import '../styles/global.css';
import { getCanonical, getAsset } from '~/utils/permalinks';

export interface Props extends MetaSEO {
  title: string;
  description: string;
  image?: string;
  dontUseTitleTemplate?: boolean;
}

const canonicalURL = new URL(Astro.url.pathname, Astro.site);

const {
  title,
  description,
  image = '/placeholder-social.jpg',

  canonical = getCanonical(String(Astro.url.pathname)),
  noindex = false,
  nofollow = false,

  ogTitle = title,
  ogType = 'website',

  dontUseTitleTemplate = false,
} = Astro.props;
---

<!-- Global Metadata -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<!-- Primary Meta Tags -->
<meta name="title" content={title} />

<AstroSeo
  title={title}
  titleTemplate={dontUseTitleTemplate ? '%s' : `%s â€” ${SITE.title}`}
  description={description}
  canonical={String(canonical)}
  noindex={noindex}
  nofollow={nofollow}
  openGraph={{
    url: String(canonical),
    title: ogTitle,
    description: description,
    type: ogType,
    images: image
      ? [
          {
            url: image.toString(),
            alt: ogTitle,
          },
        ]
      : undefined,
    // site_name: SITE.title,
  }}
  twitter={{
    handle: '@xqsit94',
    site: '@lifeofdev',
    cardType: image ? 'summary_large_image' : undefined,
  }}
/>

<!-- Google Site Verification -->
{SITE.googleSiteVerificationId && <meta name="google-site-verification" content={SITE.googleSiteVerificationId} />}

<!-- Google Analytics -->
{SITE.googleAnalyticsId && <GoogleAnalytics id={String(SITE.googleAnalyticsId)} partytown={true} />}

<link rel="shortcut icon" href={getAsset('/favicon.ico')} />
<link rel="icon" type="image/svg+xml" href={getAsset('/favicon.svg')} />
<link rel="mask-icon" href={getAsset('/favicon.svg')} color="#8D46E7" />
<link rel="sitemap" href={getAsset('/sitemap-index.xml')} />
